<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Game Maker Intro â€“ Catch the Stars</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #0d0d2b;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      font-family: 'Segoe UI', sans-serif;
      color: #fff;
    }
    h1 { margin-bottom: 12px; font-size: 1.6rem; letter-spacing: 2px; color: #ffd700; }
    #gameCanvas {
      border: 2px solid #ffd700;
      border-radius: 6px;
      background: #111133;
      display: block;
    }
    #ui {
      display: flex;
      gap: 40px;
      margin-top: 10px;
      font-size: 1rem;
    }
    #ui span { color: #aad4ff; }
    #ui strong { color: #fff; }
    #message {
      margin-top: 14px;
      font-size: 0.9rem;
      color: #ccc;
      min-height: 1.2em;
    }
  </style>
</head>
<body>
  <h1>â­ Catch the Stars</h1>
  <canvas id="gameCanvas" width="480" height="520"></canvas>
  <div id="ui">
    <div>Score: <strong id="scoreDisplay">0</strong></div>
    <div>Lives: <strong id="livesDisplay">3</strong></div>
    <div>Level: <strong id="levelDisplay">1</strong></div>
  </div>
  <div id="message">Use â† â†’ arrow keys or A / D to move. Press Space to start.</div>

  <script>
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  Game Maker Intro â€“ core concepts demonstrated
    //    â€¢ Game loop (requestAnimationFrame)
    //    â€¢ Objects  (player, falling items)
    //    â€¢ Collision detection (AABB)
    //    â€¢ Rooms    (start screen â†’ playing â†’ game over)
    //    â€¢ Sprites  (drawn with Canvas 2D API)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    const canvas  = document.getElementById('gameCanvas');
    const ctx     = canvas.getContext('2d');
    const W = canvas.width, H = canvas.height;

    // â”€â”€ UI refs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const scoreEl = document.getElementById('scoreDisplay');
    const livesEl = document.getElementById('livesDisplay');
    const levelEl = document.getElementById('levelDisplay');
    const msgEl   = document.getElementById('message');

    // â”€â”€ Game state â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let state       = 'start';   // 'start' | 'playing' | 'gameover'
    let score       = 0;
    let lives       = 3;
    let level       = 1;
    let frameCount  = 0;
    let spawnRate   = 80;        // frames between star spawns

    // â”€â”€ Input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const keys = {};
    window.addEventListener('keydown', e => {
      keys[e.code] = true;
      if (e.code === 'Space') handleSpace();
      e.preventDefault();
    });
    window.addEventListener('keyup', e => { keys[e.code] = false; });

    function handleSpace() {
      if (state === 'start' || state === 'gameover') startGame();
    }

    // â”€â”€ Player (object) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const PLAYER_W = 56, PLAYER_H = 24;
    const player = {
      x: W / 2 - PLAYER_W / 2,
      y: H - 60,
      w: PLAYER_W,
      h: PLAYER_H,
      speed: 5,
      color: '#4fc3f7',

      update() {
        if (keys['ArrowLeft']  || keys['KeyA']) this.x -= this.speed;
        if (keys['ArrowRight'] || keys['KeyD']) this.x += this.speed;
        this.x = Math.max(0, Math.min(W - this.w, this.x));
      },

      draw() {
        // basket / catcher
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.moveTo(this.x, this.y);
        ctx.lineTo(this.x + this.w, this.y);
        ctx.lineTo(this.x + this.w - 10, this.y + this.h);
        ctx.lineTo(this.x + 10, this.y + this.h);
        ctx.closePath();
        ctx.fill();

        // glow
        ctx.shadowColor = this.color;
        ctx.shadowBlur  = 12;
        ctx.fill();
        ctx.shadowBlur  = 0;
      }
    };

    // â”€â”€ Stars (falling objects) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const STAR_TYPES = [
      { label: 'â­', points: 10, speed: 2.5, color: '#ffd700', r: 14 },
      { label: 'ğŸ’', points: 25, speed: 3.5, color: '#80dfff', r: 11 },
      { label: 'ğŸ’£', points: -1, speed: 4.0, color: '#ff4d4d', r: 12 }, // bomb â€“ lose a life
    ];

    let fallingItems = [];

    function spawnItem() {
      const typeIdx = Math.random() < 0.15 ? 2           // 15% bomb
                    : Math.random() < 0.25 ? 1           // 25% diamond
                    : 0;                                  // 60% star
      const t = STAR_TYPES[typeIdx];
      fallingItems.push({
        x: t.r + Math.random() * (W - 2 * t.r),
        y: -t.r,
        r: t.r,
        speed: t.speed + (level - 1) * 0.4,
        ...t,
        typeIdx,
        angle: 0,
      });
    }

    function updateItems() {
      for (let i = fallingItems.length - 1; i >= 0; i--) {
        const item = fallingItems[i];
        item.y     += item.speed;
        item.angle += 0.05;

        // collision with player (AABB vs circle)
        if (
          item.y + item.r > player.y &&
          item.y - item.r < player.y + player.h &&
          item.x + item.r > player.x &&
          item.x - item.r < player.x + player.w
        ) {
          if (item.typeIdx === 2) {        // bomb
            lives--;
            livesEl.textContent = lives;
            showHit(item.x, item.y, 'ğŸ’¥ -1 life', '#ff4d4d');
            if (lives <= 0) { state = 'gameover'; return; }
          } else {
            score += item.points * level;
            scoreEl.textContent = score;
            showHit(item.x, item.y, `+${item.points * level}`, '#ffd700');
          }
          fallingItems.splice(i, 1);
          continue;
        }

        // missed a star (not a bomb) â€“ lose a life
        if (item.y - item.r > H) {
          if (item.typeIdx !== 2) {
            lives--;
            livesEl.textContent = lives;
            showHit(item.x, H - 20, 'âœ— missed', '#ff8080');
            if (lives <= 0) { state = 'gameover'; return; }
          }
          fallingItems.splice(i, 1);
        }
      }
    }

    function drawItems() {
      for (const item of fallingItems) {
        ctx.save();
        ctx.translate(item.x, item.y);
        ctx.rotate(item.angle);
        ctx.font      = `${item.r * 1.8}px serif`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(item.label, 0, 0);
        ctx.restore();
      }
    }

    // â”€â”€ Floating hit-text particles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const particles = [];
    function showHit(x, y, text, color) {
      particles.push({ x, y, text, color, life: 60 });
    }
    function updateDrawParticles() {
      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.y    -= 1;
        p.life -= 1;
        ctx.globalAlpha = p.life / 60;
        ctx.fillStyle   = p.color;
        ctx.font        = 'bold 14px Segoe UI';
        ctx.textAlign   = 'center';
        ctx.fillText(p.text, p.x, p.y);
        ctx.globalAlpha = 1;
        if (p.life <= 0) particles.splice(i, 1);
      }
    }

    // â”€â”€ Background stars (decoration) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const bgStars = Array.from({ length: 60 }, () => ({
      x: Math.random() * W,
      y: Math.random() * H,
      r: Math.random() * 1.5 + 0.3,
      twinkle: Math.random() * Math.PI * 2,
    }));
    function drawBackground() {
      ctx.fillStyle = '#111133';
      ctx.fillRect(0, 0, W, H);
      for (const s of bgStars) {
        s.twinkle += 0.03;
        ctx.globalAlpha = 0.4 + 0.6 * Math.abs(Math.sin(s.twinkle));
        ctx.fillStyle   = '#fff';
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;
    }

    // â”€â”€ Level progression â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function checkLevel() {
      const newLevel = 1 + Math.floor(score / 200);
      if (newLevel > level) {
        level     = newLevel;
        spawnRate = Math.max(20, 80 - (level - 1) * 10);
        levelEl.textContent = level;
        showHit(W / 2, H / 2, `â¬† Level ${level}!`, '#aaffaa');
      }
    }

    // â”€â”€ Screens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function drawStartScreen() {
      drawBackground();
      ctx.fillStyle = 'rgba(0,0,0,0.55)';
      ctx.fillRect(0, 0, W, H);

      ctx.fillStyle   = '#ffd700';
      ctx.font        = 'bold 36px Segoe UI';
      ctx.textAlign   = 'center';
      ctx.fillText('â­ Catch the Stars', W / 2, H / 2 - 60);

      ctx.fillStyle = '#ccc';
      ctx.font      = '18px Segoe UI';
      ctx.fillText('Catch â­ and ğŸ’, avoid ğŸ’£', W / 2, H / 2 - 10);
      ctx.fillText('Use â† â†’ or A / D to move', W / 2, H / 2 + 22);

      ctx.fillStyle = '#4fc3f7';
      ctx.font      = 'bold 20px Segoe UI';
      ctx.fillText('Press  SPACE  to start', W / 2, H / 2 + 70);

      msgEl.textContent = 'Use â† â†’ arrow keys or A / D to move. Press Space to start.';
    }

    function drawGameOverScreen() {
      ctx.fillStyle = 'rgba(0,0,0,0.65)';
      ctx.fillRect(0, 0, W, H);

      ctx.fillStyle = '#ff4d4d';
      ctx.font      = 'bold 42px Segoe UI';
      ctx.textAlign = 'center';
      ctx.fillText('Game Over', W / 2, H / 2 - 50);

      ctx.fillStyle = '#ffd700';
      ctx.font      = '26px Segoe UI';
      ctx.fillText(`Final Score: ${score}`, W / 2, H / 2 + 4);

      ctx.fillStyle = '#aad4ff';
      ctx.font      = '18px Segoe UI';
      ctx.fillText(`Reached Level ${level}`, W / 2, H / 2 + 40);

      ctx.fillStyle = '#4fc3f7';
      ctx.font      = 'bold 20px Segoe UI';
      ctx.fillText('Press  SPACE  to play again', W / 2, H / 2 + 90);

      msgEl.textContent = 'Press Space to play again.';
    }

    // â”€â”€ Game lifecycle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function startGame() {
      score        = 0;
      lives        = 3;
      level        = 1;
      frameCount   = 0;
      spawnRate    = 80;
      fallingItems = [];
      player.x     = W / 2 - PLAYER_W / 2;
      scoreEl.textContent = score;
      livesEl.textContent = lives;
      levelEl.textContent = level;
      msgEl.textContent   = 'Use â† â†’ arrow keys or A / D to move.';
      state = 'playing';
    }

    // â”€â”€ Main game loop â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function loop() {
      if (state === 'start') {
        drawStartScreen();
      } else if (state === 'playing') {
        drawBackground();
        frameCount++;

        if (frameCount % spawnRate === 0) spawnItem();

        player.update();
        updateItems();
        checkLevel();

        drawItems();
        player.draw();
        updateDrawParticles();
      } else if (state === 'gameover') {
        drawBackground();
        drawItems();
        player.draw();
        drawGameOverScreen();
      }

      requestAnimationFrame(loop);
    }

    // â”€â”€ Bootstrap â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    loop();
  </script>
</body>
</html>
